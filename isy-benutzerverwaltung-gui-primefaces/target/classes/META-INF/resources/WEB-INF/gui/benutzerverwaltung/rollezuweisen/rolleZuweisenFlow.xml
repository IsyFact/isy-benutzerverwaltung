<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns="http://www.springframework.org/schema/webflow"
      xsi:schemaLocation="http://www.springframework.org/schema/webflow
        http://www.springframework.org/schema/webflow/spring-webflow-2.4.xsd"
      parent="applikationseiteParentFlow">

    <secured attributes="Benutzerverwaltung.Benutzer.Aendern"/>

    <var name="rollenZuweisenModel"
         class="de.bund.bva.isyfact.benutzerverwaltung.gui.benutzerverwaltung.rollenzuweisung.RollenZuweisungModel"/>

    <on-start>
        <evaluate
                expression="rolleZuweisenController.initialisiereModel(rollenZuweisenModel)"/>
    </on-start>

    <view-state id="rolleZuweisenViewState" model="rollenZuweisenModel">
        <attribute name="headlineKey" value="MAS_Rollenverwaltung_Headline"/>

        <!-- Waehle alle Benutzer aus -->
        <transition on="alleAuswaehlen" to="alleAuswaehlen">
            <evaluate
                    expression="rolleZuweisenController.alleAuswaehlen(rollenZuweisenModel)"/>
        </transition>

        <!-- aktualisiere Benutzer Rollenzuweisungen -->
        <transition on="aktualisiereBenutzerRollenZuweisung" to="rolleZuweisenViewState">
            <evaluate
                    expression="rolleZuweisenController.aktualisiereRollenAllerBenutzer(rollenZuweisenModel)"/>
            <evaluate expression="rolleZuweisenController.initialisiereModel(rollenZuweisenModel)"/>
        </transition>

        <transition on="back" to="end"/>
    </view-state>

    <end-state id="end"></end-state>
</flow>
